# Client Usage of the Tagger API

## Prerequisites

* To use the tagger API, client needs a configarion file with appropriate URLs and private key, e.g. ```configs.json```

```json
{
  "space_id": "ispc3ANoVSzNA3P6t7abLR69ho5YPPZU",
  "api" : {"url": "http://192.168.90.214"},
  "fs": "os",
  "ethereum": {
    "url": "http://192.168.90.214/eth/",
    "private_key" : "0xxxx"
  },
  "log": {
    "level": "warn",
    "formatter": "console",
    "named": {
      "/cli": {
        "level": "warn",
        "formatter": "console"
      },
      "/cli-result": {
        "level": "normal",
        "formatter": ""
      }
    }
  },
  "silence_error": false
}
```

*  ```elv``` on Mac (or ```qfab_cli``` on Linux), ```jq```, and ```curl```

```
brew tap eluv-io/eluv-io
brew install elv jq curl
```
* ```<object id>``` and ```<library id>```

## Usage of  the ```tag-cli```
```
Usage: tag-cli [command] [flags]

Available commands:
    tag         Invoke a tagging process
    status      Check the status of a tagging process
    stop        Stop a tagging process
    finalize    Finalize the content object with tag files/links uploaded

Flags:
    library id		Library id of the content object
    object id		Object id of the content object
    write token		Write token for editing the content
    --config            Client configuration for fabric networks
    --lro_handle        LRO handle returned by the tagging process
    -c, --container_id  Container index to run the tagger, [0, 1, 2]
    -s, --start_time    Start time of the video to run the tagger
    -e, --end_time      End time of the video to run the tagger
    -i, --interval      Time interval, multiple of which one tagging process aims for
    -f, --features      Machine learning features to tag, options ["celeb", "ocr", "od", "landmark", "action", "segment", "logo"]
```

* Invoke the tagging process

```
 ./bin/tag-cli tag <library id> <object id> -c=<container id> -s=<start time> -e=<end time> -i=<interval> -f=<features> --config=<config>
```

* Stop the tagging process

```
./bin/tag-cli stop <library id> <object id> -c=<container id> --config=<config>
```

* Check that status of the tagging job. One would need to verify if the process is complete before the content finalize. This step requires the ```lro_handle``` generated by the tag call

```
./bin/tag-cli status <library id> <object id> -c=<container id> --config=<config> --lro_handle=<lro handle>
```

* Finalize the content if everything looks good

```
./bin/tag-cli finalize <library id> <object id>  <write token> --config=<config>
```
